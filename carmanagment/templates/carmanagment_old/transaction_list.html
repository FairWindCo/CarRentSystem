{% extends 'base.html' %}
{% load fw_main_menu %}
{% block SUB_MENU_CONTENT %}
{% endblock %}

{% block CONTENT %}
    <div id="main" class="pure-u-1">
        <div class="email-content">
            <div class="email-content-header pure-g">
                <div class="pure-u-1-2">
                    <h1 class="email-content-title">Список поездок</h1>
                    <p class="email-content-subtitle">
                        {% if current_car.name %}
                            Авто <a>{{ current_car.name }}</a>
                        {% endif %}
                        {% if filter_form_values.start_interval %}
                            c <span>{{ filter_form_values.start_interval }}</span>
                        {% endif %}
                        {% if filter_form_values.end_interval %}
                            по <span>{{ filter_form_values.end_interval }}</span>
                        {% endif %}
                    </p>
                </div>

                <div class="email-content-controls pure-u-1-2">
                    <form method="get">
                        <input type="date" name="start_interval" placeholder="from"
                               value="{{ filter_form_values.start_interval }}"/>
                        <input type="date" name="end_interval" placeholder="to"
                               value="{{ filter_form_values.end_interval }}"/>
                        <input type="text" name="car__name" placeholder="car plate"
                               value="{{ filter_form_values.car__name }}"/>
                        <button type="submit" class="secondary-button pure-button">filter</button>
                    </form>
                </div>
            </div>

            <div class="email-content-body">
                <div class="pure-g center">
                    <table class="pure-table pure-u-1 pure-table-bordered">
                        <tr>
                            <th>Транзакция</th>
                            <th>Дата</th>
                            <th colspan="3">Коментарий</th>
                        </tr>
                        <tr>
                            <th></th>
                            <th></th>
                            <th>Акаунт</th>
                            <th>Сумма</th>
                            <th>Примечание</th>
                        </tr>

                        {% for obj in object_list %}
                            <tr>
                                <td>{{ obj.id }}</td>
                                <td>{{ obj.transactionTime|date:'d-m-Y H:i:s' }}</td>
                                <td colspan="3">{{ obj.comment }}</td>
                            </tr>
                            <tr>
                                    {% for oper in obj.accounttransaction_set.all %}
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td>{{ oper.account.name }}</td>
                                            <td>{{ oper.cents_amount|floatformat:2 }} {{ obj.account.get_currency }}</td>
                                            <td>{{ oper.comment }}</td>
                                        </tr>
                                    {% endfor %}
                            </tr>
                        {% endfor %}

                    </table>
                    {% paging_navigation page_obj %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}